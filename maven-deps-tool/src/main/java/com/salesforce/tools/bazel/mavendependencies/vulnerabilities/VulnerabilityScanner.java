package com.salesforce.tools.bazel.mavendependencies.vulnerabilities;

import java.util.SortedSet;

import org.eclipse.aether.graph.DependencyNode;

import com.salesforce.tools.bazel.mavendependencies.collection.CollectionDelta.Modification;

/**
 * Contract for scanning dependencies for vulnerabilities.
 */
public interface VulnerabilityScanner {

    /**
     * Report all vulnerabilities.
     *
     * @param root
     *            root of the resolved dependency tree
     */
    void printVulnerabilities(DependencyNode root);

    /**
     * Evaluates a set of modifications to the dependency collection and returns whether the command execution should
     * abort or can continue.
     *
     *
     * @param modifications
     *            the set of modifications
     * @param interactive
     *            <code>true</code> if the scanner is allowed to prompt the users, <code>false</code> otherwise (eg., in
     *            batch jobs)
     * @return <code>true</code> if the dependencies tool should abort, <code>false</code> to continue
     */
    boolean shouldAbortForModifications(SortedSet<Modification> modifications, boolean interactive);

}
